(()=>{"use strict";var e=function(e,t,n,r){return new(n||(n=Promise))((function(a,o){function i(e){try{c(r.next(e))}catch(e){o(e)}}function l(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}c((r=r.apply(e,t||[])).next())}))},t=function(e,t){var n,r,a,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(c){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(o=0)),o;)try{if(n=1,r&&(a=2&l[0]?r.return:l[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,l[1])).done)return a;switch(r=0,a&&(l=[2&l[0],a.value]),l[0]){case 0:case 1:a=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,r=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(!((a=(a=o.trys).length>0&&a[a.length-1])||6!==l[0]&&2!==l[0])){o=0;continue}if(3===l[0]&&(!a||l[1]>a[0]&&l[1]<a[3])){o.label=l[1];break}if(6===l[0]&&o.label<a[1]){o.label=a[1],a=l;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(l);break}a[2]&&o.ops.pop(),o.trys.pop();continue}l=t.call(e,o)}catch(e){l=[6,e],r=0}finally{n=a=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,c])}}},n=function(n){return e(void 0,void 0,void 0,(function(){var e,r;return t(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,fetch(n.url)];case 1:return(e=t.sent()).ok&&(n.url=e.url),[3,3];case 2:return r=t.sent(),console.error("Failed to fetch original URLs",r),[3,3];case 3:return[2]}}))}))},r=function(e){var t=e.el,n=e.elClassName,r=e.elId,a=e.elTextContent,o=e.elLoading,i=e.elSrc,l=document.createElement(t);return Object.assign(l,{className:n||"",id:r||"",textContent:a||"",loading:o||"",src:i||""}),l},a=function(e){var t,n=e.eventTarget,r=e.arr,a=n.closest(".image-wrapper");if(a){var o=null===(t=a.dataset)||void 0===t?void 0:t.id;return r.find((function(e){return e.id===Number(o)}))}},o=function(e){return new Promise((function(t){var n=e.eventTarget.closest(".image-wrapper");if(n){var r=n.querySelector(".image-text-container"),a=n.querySelector(".image-text"),o=a.textContent,i=document.createElement("textarea");i.rows=4,i.maxLength=85,i.className="image-textarea",i.value=o,a.innerHTML=i.value,r.appendChild(i),i.focus(),i.select(),a.style.display="none",i.addEventListener("blur",(function(e){var n=i.value.trim();n&&(a.textContent=n),i.remove(),a.style.display="block",t(n)})),i.addEventListener("keypress",(function(e){"Enter"===e.key&&i.blur()}))}}))},i=function(e){var t=e.array,n=e.filename,r=function(e){var t=e.arr;return function(e,t,n){if(n||2===arguments.length)for(var r,a=0,o=t.length;a<o;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))}([Object.keys(t[0]).join(",")],t.map((function(e){return Object.values(e).join(",")})),!0).join("\n")}({arr:t}),a=new Blob([r],{type:"text/csv;charset=utf-8;"}),o=URL.createObjectURL(a),i=document.createElement("a");i.setAttribute("download",n),i.href=o,i.click(),URL.revokeObjectURL(o)};function l(){return e=this,t=void 0,r=function(){var e;return function(e,t){var n,r,a,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(c){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(o=0)),o;)try{if(n=1,r&&(a=2&l[0]?r.return:l[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,l[1])).done)return a;switch(r=0,a&&(l=[2&l[0],a.value]),l[0]){case 0:case 1:a=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,r=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(!((a=(a=o.trys).length>0&&a[a.length-1])||6!==l[0]&&2!==l[0])){o=0;continue}if(3===l[0]&&(!a||l[1]>a[0]&&l[1]<a[3])){o.label=l[1];break}if(6===l[0]&&o.label<a[1]){o.label=a[1],a=l;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(l);break}a[2]&&o.ops.pop(),o.trys.pop();continue}l=t.call(e,o)}catch(e){l=[6,e],r=0}finally{n=a=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,c])}}}(this,(function(t){switch(t.label){case 0:return[4,fetch("https://gist.githubusercontent.com/lilla-nemeth/888f537b4a9f52ddd97a369948b74c0a/raw/97f179c8fc37a8ba0ce1b0c891f102bc9cb32448/images.json")];case 1:if(!(e=t.sent()).ok)throw new Error("Fetching images has failed");return[4,e.json()];case 2:return[2,t.sent()]}}))},new((n=void 0)||(n=Promise))((function(a,o){function i(e){try{c(r.next(e))}catch(e){o(e)}}function l(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}c((r=r.apply(e,t||[])).next())}));var e,t,n,r}var c,u,s,f,p=document.getElementById("content-container"),d=[];c=void 0,u=void 0,f=function(){var a;return function(e,t){var n,r,a,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(c){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(o=0)),o;)try{if(n=1,r&&(a=2&l[0]?r.return:l[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,l[1])).done)return a;switch(r=0,a&&(l=[2&l[0],a.value]),l[0]){case 0:case 1:a=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,r=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(!((a=(a=o.trys).length>0&&a[a.length-1])||6!==l[0]&&2!==l[0])){o=0;continue}if(3===l[0]&&(!a||l[1]>a[0]&&l[1]<a[3])){o.label=l[1];break}if(6===l[0]&&o.label<a[1]){o.label=a[1],a=l;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(l);break}a[2]&&o.ops.pop(),o.trys.pop();continue}l=t.call(e,o)}catch(e){l=[6,e],r=0}finally{n=a=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,c])}}}(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,l()];case 1:return d=o.sent(),i={images:d,container:p},e(void 0,void 0,void 0,(function(){var e,a,o,l;return t(this,(function(t){switch(t.label){case 0:return e=i.images,a=i.container,[4,Promise.all(e.map(n))];case 1:return t.sent(),o=e.map((function(e){var t=r({el:"div",elClassName:"image-wrapper",elId:"image-text-".concat(e.id)});t.setAttribute("data-id",e.id.toString());var n=r({el:"img",elClassName:"image",elLoading:"lazy",elSrc:e.url}),a=r({el:"div",elClassName:"image-text-container"}),o=r({el:"p",elClassName:"image-text",elTextContent:e.text});return t.appendChild(n),t.appendChild(a),a.appendChild(o),t})),l=r({el:"div",elClassName:"image-container"}),o.forEach((function(e){l.appendChild(e)})),a.appendChild(l),[2]}}))})),[3,3];case 2:throw a=o.sent(),console.log(a),new Error;case 3:return[2]}var i}))},new((s=void 0)||(s=Promise))((function(e,t){function n(e){try{a(f.next(e))}catch(e){t(e)}}function r(e){try{a(f.throw(e))}catch(e){t(e)}}function a(t){var a;t.done?e(t.value):(a=t.value,a instanceof s?a:new s((function(e){e(a)}))).then(n,r)}a((f=f.apply(c,u||[])).next())}));var v=function(){var e=r({el:"div",elClassName:"context-menu-wrapper",elId:"context-menu-wrapper"}),t=r({el:"ul",elClassName:"context-menu",elId:"context-menu"}),n=r({el:"li",elTextContent:"Delete",elId:"context-menu-delete",elClassName:"context-menu-actions"}),a=r({el:"li",elTextContent:"Edit Text",elId:"context-menu-edit",elClassName:"context-menu-actions"}),o=r({el:"li",elTextContent:"Export List to CSV",elId:"context-menu-csv",elClassName:"context-menu-actions"});return t.appendChild(n),t.appendChild(a),t.appendChild(o),e.appendChild(t),e}();document.body.appendChild(v);var h=null;p.addEventListener("contextmenu",(function(e){(h=e.target).closest(".image-wrapper")&&function(e,t){t.preventDefault(),e.classList.add("visible"),e.style.left="".concat(t.pageX,"px"),e.style.top="".concat(t.pageY,"px")}(v,e)})),document.addEventListener("click",(function(n){var r,l=n.target;if(h)switch(l.id){case"context-menu-edit":o({eventTarget:h}),r={eventTarget:h,arr:d},e(void 0,void 0,void 0,(function(){var e,n,i,l,c;return t(this,(function(t){switch(t.label){case 0:return(i=a({eventTarget:e=r.eventTarget,arr:n=r.arr}))&&(l=n.indexOf(i))>-1?[4,o({eventTarget:e})]:[3,2];case 1:c=t.sent(),n[l].text=c,t.label=2;case 2:return[2]}}))})),h=null;break;case"context-menu-delete":!function(e){var t=e.arr,n=a({eventTarget:e.eventTarget,arr:t});if(n){var r=t.indexOf(n);r>-1&&t.splice(r,1)}}({eventTarget:h,arr:d}),function(e){var t=e.eventTarget,n=e.styleClass,r=null==t?void 0:t.closest(n);null==r||r.remove()}({eventTarget:h,styleClass:".image-wrapper"}),h=null;break;case"context-menu-csv":i({array:d,filename:"list.csv"})}!function(e){e.classList.remove("visible")}(v)}))})();